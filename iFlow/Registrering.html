<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Timeregistrering</title>
    <link rel="stylesheet" href="styles/MyStyle.css" />
    <script src="Scripts/jquery-1.4.1.js" type="text/javascript"></script>
    <script type="text/javascript">

        function InsertHour() {
            alert('Start innsetting');

            try {
                var connection = new ActiveXObject("ADODB.Connection");
                alert('ActiveX aktivert');
                var connectionstring = "Data Source=localhost\sqlexpress;Initial Catalog=iFlow;User ID=saiflow;Password=!?ah5HfR&n;Provider=SQLOLEDB";

                connection.Open(connectionstring);

                var rs = new ActiveXObject("ADODB.Recordset");

                rs.Open("insert into TimeTimeRegistrations (Hours, Notes) values(10, 'Testkommentar')", connection);
                rs.MoveFirst
                while (!rs.eof) {
                    document.write(rs.fields(1));
                    rs.movenext;
                }

                rs.close;
                connection.close;
            } catch (error) {

                alert(error);
            }

        }



        function DeleteText() {
            document.getElementById('txtPhone').value = '';
        }
        function KeyPress() {

            if (document.activeElement.id == 'btnOK') {

                if (document.getElementById('txtPhone').placeholder == 'Telefonnummer') {
                    document.getElementById('txtPhone').placeholder = 'Antall Timer';

                    document.getElementById('btnRegister').style.display = "block";
                }

                else if (documnet.getElementById('txtPhone').placeholder == "Antall Timer") {
                    document.getElementById('comment').focus();
                    document.getElementById('btnRegister').style.display = "none";
                }

                document.getElementById('txtPhone').value = '';
                document.getElementById('txtPhone').focus();
            }
            else if (document.activeElement.id == 'btnBack') {
                var text = document.getElementById('txtPhone').value;
                document.getElementById('txtPhone').value = text.substring(0, text.length - 1);
            }
            else if (document.activeElement.id != 'btnDEL' && document.activeElement.id != 'btnBack') {

                document.getElementById('txtPhone').value += document.activeElement.innerHTML;
                document.getElementById('txtPhone').focus();
            }
        }
        function RegisterPhone() {

            if (document.getElementById('txtPhone').value != '' && document.getElementById('phone').value != null) {
                if (document.getElementById('txtPhone').placeholder == 'Telefonnummer') {
                    document.getElementById('phoneNumber').value = document.getElementById('phone').value;
                    document.getElementById('txtPhone').placeholder = 'Antall Timer';

                    document.getElementById('btnRegister').style.display = "block";
                    document.getElementById('btnRegister').innerText = 'Registrer Timer';
                    document.getElementById('btnRegister').setAttribute('onclick', 'RegisterTime()');
                    document.getElementById('txtPhone').value = '';
                    document.getElementById('txtPhone').focus();
                }
            }
            else {
                alert('SKriv inn gyldig telefonnummer!');
            }
            alert(document.getElementById('phoneNumber').value);
        }
        function RegisterTime() {

            var validPhone = false;
            var validHour = false;

            if (document.getElementById('phone').value == '' || document.getElementById('phone').value == null) {
                alert('Du må legge inn antall timer');
                document.getElementById('phone').focus();
            }
            else
                validHour = true;

            if (document.getElementById('comment').value == '' || document.getElementById('comment').value == null) {
                alert('Du må registrere kommentar');

                if (validHour == true)
                    document.getElementById('comment').focus();
            }
            else
                validPhone = true;


            if (validPhone == true && validHour == true) {
                alert('Du har registrert ' + document.getElementById('phone').value + ' timer på dato ' + document.getElementById('datePicker').value);

                document.getElementById('comment').value = '';
                document.getElementById('txtPhone').value = '';
                documnet.getElementById('txtPhone').setAttribute('onclick', 'RegisterPhone');
                document.getElementById('txtPhone').placeholder = 'Telefonnummer';
                document.getElementById('txtPhone').focus();
            }
            else
                alert('Timeregistrering feilet!');
        }


        function LoadPage() {
            document.getElementById('datePicker').value = new Date().toISOString().substr(0, 10);
            document.getElementById('phone').focus();
        }
    </script>



</head>

<?php
    $host="myname.database.windows.net";
    $username="theUser";
    $password="password";
    $database="databaseName";
    $tbl_name="tableName";

    $mysql = mysql_connect($host, $username, $password)or die("cannot connect");
    mysql_select_db($database);
    $sql='SELECT * FROM $tbl_name';
    $result=mysql_query($sql);

    ?>

<body onload="LoadPage()">
    <!--<img style="width:200px;height:90px;" src="https://www.iflow.no/wp-content/uploads/2022/04/Logo_oransje_uten_payoff.png" />-->
    <h1 style="color:#ff7500;">Timeregistrering</h1>
    <input type="hidden" id="phoneNumber" />
    <input type="hidden" id="hoursRegistered" />
    <input class="t1" placeholder="Telefonnummer" id="txtPhone" type="text" />
    <br />
    <div>
        <div>
            <button id="btn1" class="b1" onclick="KeyPress()">1</button>
            <button id="btn2" class="b1" onclick="KeyPress()">2</button>
            <button id="btn3" class="b1" onclick="KeyPress()">3</button>
        </div>
        <div>
            <button id="btn4" class="b1" onclick="KeyPress()">4</button>
            <button id="btn5" class="b1" onclick="KeyPress()">5</button>
            <button id="btn6" class="b1" onclick="KeyPress()">6</button>
        </div>
        <div>
            <button id="btn7" class="b1" onclick="KeyPress()">7</button>
            <button id="btn8" class="b1" onclick="KeyPress()">8</button>
            <button id="btn9" class="b1" onclick="KeyPress()">9</button>
        </div>
        <div>
            <button id="btnBack" class="b1" onclick="KeyPress()">BACK</button>
            <button id="btn0" class="b1" onclick="KeyPress()">0</button>
            <button id="btnDEL" class="b1" onclick="KeyPress()">DEL</button>
        </div>
    </div>
    <div style="align-content:inherit">
        <input class="t1" id="datePicker" type="date" />
        <textarea class="t1" id="comment" placeholder="Skriv notat" style="height:100px;width:300px" rows="1"></textarea>
    </div>
    <div>
        <button id="btnRegister" style="width:245px" class="b1" onclick="RegisterPhone()">Registrer Telefon</button>
        <button onclick="InsertHour()" class="b1" runat="server">Legg til</button>
    </div>
</body>
</html>